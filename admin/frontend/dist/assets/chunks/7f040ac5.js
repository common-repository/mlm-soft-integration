var L=Object.defineProperty;var C=(t,s,e)=>s in t?L(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e;var r=(t,s,e)=>(C(t,typeof s!="symbol"?s+"":s,e),e);import{C as f,W as j}from"./bcd39eff.js";import{M as D,B as w}from"./079d606a.js";import{M as H,a as h,T as W}from"./9f99010c.js";import{M as E,a as T,W as I,A as M,C as B,O as F}from"./99472363.js";import{M as P,a as U,b as A,S as R}from"./e1eaa995.js";import{n as S}from"../entry/index.js";const p=class{};let l=p;r(l,"Prefix",P.PluginPrefix+"pos_integration_"),r(l,"Enabled",p.Prefix+"enabled"),r(l,"PosWPOrderStatusMatch",p.Prefix+"pos_wc_order_status_match");var V=Object.defineProperty,N=Object.getOwnPropertyDescriptor,z=(t,s,e,o)=>{for(var a=o>1?void 0:o?N(s,e):s,n=t.length-1,i;n>=0;n--)(i=t[n])&&(a=(o?i(s,e,a):i(a))||a);return o&&a&&V(s,e,a),a};let m=class extends h{constructor(){super(...arguments);r(this,"BooleanOption",w);r(this,"TextOption",W);r(this,"PosOptions",l)}mounted(){super.mounted()}};m=z([f({components:{MTextOption:H,MSponsorFieldOption:E,MOrderStatusOption:T,MBooleanOption:D}})],m);var k=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("v-container",[e("v-form",{model:{value:t.valid,callback:function(o){t.valid=o},expression:"valid"}},[e("m-boolean-option",{attrs:{option:t.BooleanOption,name:t.PosOptions.Enabled,label:t.$t("integrations.pos.base.enabled")}}),e("v-btn",{staticClass:"mt-5",attrs:{disabled:!t.valid,color:"success",loading:t.optionsStore.optionsLoading},on:{click:t.saveHandler}},[t._v(" "+t._s(t.$t("save"))+" ")])],1)],1)},q=[];const O={};var G=S(m,k,q,!1,J,null,null,null);function J(t){for(let s in O)this[s]=O[s]}var K=function(){return G.exports}();class Q{constructor(){r(this,"posStatus");r(this,"wcStatus")}}const g=class extends U{constructor(){super(P.PluginPrefix+"pos_admin_api_endpoint")}getPosOrderStatuses(){return this.callHandler("get-pos-order-statuses")}};let c=g;r(c,"instance",new g);const b=class{constructor(){r(this,"items",[]);r(this,"storeLoaded",!1);r(this,"storeLoading",!1);r(this,"nextUpdate")}async loadIfNeeded(){(!this.storeLoaded&&!this.storeLoading||this.nextUpdate>new Date().getTime())&&(this.storeLoading=!0,this.items=await this.loadItems(),this.nextUpdate=new Date().getTime()+b.UpdateTime,this.storeLoading=!1,this.storeLoaded=!0)}};let u=b;r(u,"UpdateTime",1e3);class X{constructor(s,e){this.alias=s,this.title=e}}var Y=Object.defineProperty,Z=Object.getOwnPropertyDescriptor,tt=(t,s,e,o)=>{for(var a=o>1?void 0:o?Z(s,e):s,n=t.length-1,i;n>=0;n--)(i=t[n])&&(a=(o?i(s,e,a):i(a))||a);return o&&a&&Y(s,e,a),a};let v=class extends u{async loadItems(){const t=[],s=await I.instance.getOrderStatuses(),e=Object.keys(s);for(let o=0;o<e.length;o++){const a=e[o];t.push(new X(a,s[a]))}return t}get statusMap(){return M.createMap(this.items,"alias")}};v=tt([A],v);var et=Object.defineProperty,st=Object.getOwnPropertyDescriptor,at=(t,s,e,o)=>{for(var a=o>1?void 0:o?st(s,e):s,n=t.length-1,i;n>=0;n--)(i=t[n])&&(a=(o?i(s,e,a):i(a))||a);return o&&a&&et(s,e,a),a};let _=class extends h{constructor(){super(...arguments);r(this,"woocommerceOrderStatusStore",R.use(v));r(this,"headers",{});r(this,"matches",[]);r(this,"defaultItem",new Q);r(this,"posStatuses",[]);r(this,"posStatusesLoading",!1)}get posStatusMap(){return M.createMap(this.posStatuses,"id")}changeHandler(){this.optionsStore.setUnsavedValue(l.PosWPOrderStatusMatch,this.matches)}async saveOptionsHandler(){this.optionsStore.setUnsavedValue(l.PosWPOrderStatusMatch,this.matches),await this.optionsStore.updateOptions()}loadData(){this.posStatusesLoading=!0,c.instance.getPosOrderStatuses().then(s=>{this.posStatuses=s}).finally(()=>{this.posStatusesLoading=!1}),this.woocommerceOrderStatusStore.loadIfNeeded()}setFields(){this.matches=this.optionsStore.getOptionValue(l.PosWPOrderStatusMatch)||[],this.headers=[{text:this.$t("integrations.pos.statusMatch.wcStatus"),sortable:!0,value:"wcStatus"},{text:this.$t("integrations.pos.statusMatch.posStatus"),sortable:!0,value:"posStatus"}]}created(){this.setFields(),this.loadData()}};_=at([f({components:{CrudTable:B}})],_);var ot=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("crud-table",{attrs:{headers:t.headers,items:t.matches,"default-item":t.defaultItem},on:{change:t.changeHandler},scopedSlots:t._u([{key:"editForm",fn:function(o){var a=o.editItem;return[e("v-select",{attrs:{items:t.woocommerceOrderStatusStore.items,"item-text":"title","item-value":"alias",loading:t.woocommerceOrderStatusStore.storeLoading,label:t.$t("integrations.pos.statusMatch.wcStatus")},model:{value:a.wcStatus,callback:function(n){t.$set(a,"wcStatus",n)},expression:"editItem.wcStatus"}}),e("v-select",{attrs:{items:t.posStatuses,"item-text":"title","item-value":"id",loading:t.posStatusesLoading,label:t.$t("integrations.pos.statusMatch.posStatus")},model:{value:a.posStatus,callback:function(n){t.$set(a,"posStatus",n)},expression:"editItem.posStatus"}})]}},!t.woocommerceOrderStatusStore.storeLoading&&t.woocommerceOrderStatusStore.storeLoaded?{key:"item.wcStatus",fn:function(o){var a=o.item;return[t._v(" "+t._s(t.woocommerceOrderStatusStore.statusMap[a.wcStatus].title)+" ")]}}:{key:"item.wcStatus",fn:function(){return[e("v-skeleton-loader",{attrs:{type:"list-item"}})]},proxy:!0},t.posStatusesLoading?{key:"item.posStatus",fn:function(){return[e("v-skeleton-loader",{attrs:{type:"list-item"}})]},proxy:!0}:{key:"item.posStatus",fn:function(o){var a=o.item;return[t._v(" "+t._s(t.posStatusMap[a.posStatus].title)+" ")]}}],null,!0)}),e("v-btn",{staticClass:"mt-5",attrs:{disabled:!t.valid,color:"success",loading:t.optionsStore.optionsLoading},on:{click:t.saveHandler}},[t._v(" "+t._s(t.$t("save"))+" ")])],1)},rt=[];const x={};var nt=S(_,ot,rt,!1,it,null,null,null);function it(t){for(let s in x)this[s]=x[s]}var lt=function(){return nt.exports}(),ct=Object.defineProperty,ut=Object.getOwnPropertyDescriptor,y=(t,s,e,o)=>{for(var a=o>1?void 0:o?ut(s,e):s,n=t.length-1,i;n>=0;n--)(i=t[n])&&(a=(o?i(s,e,a):i(a))||a);return o&&a&&ct(s,e,a),a};let d=class extends h{constructor(){super(...arguments);r(this,"tabs",[]);r(this,"enabled",!1)}mounted(){super.mounted(),this.preloaded&&this.setEnabled()}optionLoadingChanged(s){super.optionLoadingChanged(s),s||this.setEnabled()}setEnabled(){const s=this.optionsStore.getOption(l.Enabled,w);this.enabled=s.value.value}};y([j("optionsStore.optionsLoading")],d.prototype,"optionLoadingChanged",1);d=y([f({components:{OrderStatusMatch:lt,BaseSettings:K,OptionsSkeletonLoader:F}})],d);var dt=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("v-container",[e("v-tabs",{attrs:{centered:""},model:{value:t.tabs,callback:function(o){t.tabs=o},expression:"tabs"}},[e("v-tab",[t._v(t._s(t.$t("integrations.pos.base.tabHeader")))]),e("v-tab",[t._v(t._s(t.$t("integrations.pos.statusMatch.tabHeader")))])],1),e("v-tabs-items",{model:{value:t.tabs,callback:function(o){t.tabs=o},expression:"tabs"}},[e("v-tab-item",[e("v-card",{attrs:{flat:""}},[e("v-card-title",{staticClass:"text-h5"},[t._v(" "+t._s(t.$t("integrations.pos.base.tabHeader"))+" ")]),e("v-card-text",[e("options-skeleton-loader",{attrs:{loading:!t.preloaded}},[e("base-settings")],1)],1)],1)],1),e("v-tab-item",[e("v-card",{attrs:{flat:""}},[e("v-card-title",{staticClass:"text-h5"},[t._v(" "+t._s(t.$t("integrations.pos.statusMatch.tabHeader"))+" ")]),e("v-card-text",[e("options-skeleton-loader",{attrs:{loading:!t.preloaded}},[e("order-status-match")],1)],1)],1)],1)],1)],1)},pt=[];const $={};var mt=S(d,dt,pt,!1,vt,null,null,null);function vt(t){for(let s in $)this[s]=$[s]}var xt=function(){return mt.exports}();export{xt as default};
